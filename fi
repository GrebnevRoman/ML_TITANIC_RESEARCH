WITH feedBinSwitch_l_active AS (
  SELECT feedBin_h_hk_active, endDate_dts
  FROM your_table_name
  WHERE feedBin_h_hk_active IS NOT NULL
), feedBinSwitch_l_inactive AS (
  SELECT feedBin_h_hk_inactive, startDate_dts
  FROM your_table_name
  WHERE feedBin_h_hk_inactive IS NOT NULL
), valid_feedBinSwitch_l_all_sts_bs AS (
  SELECT *
  FROM your_table_name fb
  JOIN ðfeedBinSwitch_l_all_sts_bs bs ON fb.feedBinSwitch_l_hk = bs.feedBinSwitch_l_hk
  WHERE bs.currec = 1 AND bs.status = 'I'
), valid_feedBinSwitch_l_all_mn_bs AS (
  SELECT *
  FROM your_table_name fb
  JOIN ðfeedBinSwitch_l_all_mn_bs mn ON fb.feedBinSwitch_l_hk = mn.feedBinSwitch_l_hk
  WHERE mn.currec = 1
)
SELECT 
  fb.feedBinName, 
  COALESCE(fbsa.endDate_dts, fbsi.startDate_dts) AS start_date,
  COALESCE(fbsi.startDate_dts, fbsa.endDate_dts) AS end_date
FROM your_table_name fb
LEFT JOIN valid_feedBinSwitch_l_all_sts_bs bs
  ON fb.feedBinSwitch_l_hk = bs.feedBinSwitch_l_hk AND fb.startDate_dts <= bs.endDate_dts AND fb.endDate_dts >= bs.startDate_dts
LEFT JOIN valid_feedBinSwitch_l_all_mn_bs mn
  ON fb.feedBinSwitch_l_hk = mn.feedBinSwitch_l_hk AND fb.startDate_dts <= mn.endDate_dts AND fb.endDate_dts >= mn.startDate_dts
LEFT JOIN feedBinSwitch_l_active fbsa
  ON fb.feedBin_h_hk_active = fbsa.feedBin_h_hk_active AND fb.endDate_dts = fbsa.endDate_dts
LEFT JOIN feedBinSwitch_l_inactive fbsi
  ON fb.feedBin_h_hk_inactive = fbsi.feedBin_h_hk_inactive AND fb.startDate_dts = fbsi.startDate_dts
WHERE (fb.feedBin_h_hk_active IS NOT NULL OR fb.feedBin_h_hk_inactive IS NOT NULL)
